var startLoad,startSave,bin={},ff5File={},loadTime=0,saveTime=0;function bind(e,t){for(var i in e)if(e.hasOwnProperty(i)){var a=t?t+"-"+i:i,n=e[i],r=document.getElementById(a);if(r&&function(e){e=typeof e;return"number"==e||"string"==e||"boolean"==e}(n))bindElem(e,i,r);else if(Array.isArray(n))for(var o=0;o<n.length;o++){var s=a+o;bind(n[o],s)}else"object"==typeof n&&bind(n,a)}}function bindElem(e,t,i){var a;"INPUT"==i.tagName?"checkbox"==i.type?(i.checked=e[t],i.onclick=function(){e[t]=i.checked}):(i.value=e[t],a=function(){e[t]=i.value},i.onkeypress=a,i.onchange=a,i.oninput=a):i.textContent=e[t]}function loadFile(){var e,r;"function"==typeof window.FileReader?(e=document.getElementById("file-input"))?e.files?e.files[0]?(e=e.files[0],(r=new FileReader).onload=function(){$("div.description").hide(),["Bartz","Lenna","Galuf","Faris","Krile"].forEach((t,e)=>{$("div.ff5-file").append("<b><p id='"+t+"'>"+t+" Exp: <input id='"+t+"-Exp'/></p></b>");let i="<table>";for(let e=0;e<25;e++)e%3==0&&(i+="<tr>"),i=i+("<td><span id='"+t+"-jobs"+e)+"-name'/></span></td>",i=i+("<td>Lv:<input id='"+t+"-jobs"+e)+"-int1' maxlength='1' style='width: 1em;'/>",i=i+("ABP:<input id='"+t+"-jobs"+e)+"-int2' maxlength='3' style='width: 3em;'/></td>",e%3==2&&(i+="</tr>");i+="</tr>",$("div.ff5-file").append(i+"</table>")}),function(){let t="<b><p id='Items'>Items</p></b>";t+="<table>";for(let e=0;e<261;e++)e%5==0&&(t+="<tr>"),t=t+("<td><input id='items"+e)+"-int1' style='width: 3em;' maxlength='3' /></td><td><span id='items"+e+"-name'/></span></td>",e%5==4&&(t+="<tr>");t+="</tr>",$("div.ff5-file").append(t+"</table>")}(),function(){let t="<b><p id='Jobs'>Jobs Learned</p></b>";t+="<table>";for(let e=0;e<32;e++)e%5==0&&(t+="<tr>"),t=t+("<td><input type='checkbox' id='jobs"+e)+"-bit'></input></td><td><span id='jobs"+e+"-name'/></span></td>",e%5==4&&(t+="</tr>");t+="</tr>",$("div.ff5-file").append(t+"</table>")}(),function(){var t="<b><p id='Magic'>Magic/Skills Learned</p></b>";t+="<table>";for(let e=0;e<336;e++)e%5==0&&(t+="<tr>"),t=t+"<td><input type='checkbox' id='mgks"+e+"-bit'></input></td><td><span id='mgks"+e+"-name'/></span></td>",e%5==4&&(t+="</tr>");t+="</tr>",$("div.ff5-file").append(t+"</table>")}(),function(){let t="<b><p id='Bestiary'>Bestiary</p></b>";t+="<table>";for(let e=0;e<450;e++)e%5==0&&(t+="<tr>"),t=t+"<td><input id='slains"+e+"-int4' style='width: 3em;' maxlength='3' /></td><td><span id='slains"+e+"-name'/></span>:</td>",e%5==4&&(t+="</tr>");t+="</tr>",$("div.ff5-file").append(t+"</table>")}(),$("div.ff5-file").show(),startLoad=Date.now(),bin=new Bin(r.result);var e=parseInt($("input[name=file-number]:checked").val()),t=parseInt($("#all-jobs-abp").val());t&&32639<t&&(t=32639);bin.options={allJobsABP:t,allItems:parseInt($("#all-items").val()),allMagic:$("#all-magic").is(":checked"),allSlain:parseInt($("#all-slain").val())},ff5File=new FF5File(bin,e),startLoad=Date.now(),bind(ff5File);var a=$("ul.menu").text("").css({width:"16%",verticalAlign:"top",right:"10px",top:"5em",position:"absolute"}),n={border:"thin solid #82adf2",borderRadius:"4px",marginBottom:"1em",padding:"5px",backgroundColor:"#82adf2",borderColor:"#82adf2",color:"#21447c",cursor:"pointer"};["Bartz","Lenna","Galuf","Faris","Krile","Items","Jobs","Magic","Bestiary"].forEach(function(t,e){var i=$("<li>").html(t).css(n).click(function(){var e;e=t,$("html, body").animate({scrollTop:$("#"+e).offset().top},0)});a.append(i)});e=$("<li>").html("Reload").css(n).click(loadFile);a.append(e);e=$("<li>").html("Save").css(n).click(saveFile);a.append(e);e=$("<li>").html("Reset").css(n).click(function(){location.reload()});a.append(e);var i=$("#menu").offset().top-15;$(window).scroll(function(){i<$(window).scrollTop()?$("#menu").css("position","fixed").css("top","10px"):$("#menu").css("position","absolute").css("top","")}),loadTime=Date.now()-startLoad,$("#status").text("loadTime: "+loadTime)},r.readAsArrayBuffer(e)):bodyAppend("p","Please select a file before clicking 'Load'"):bodyAppend("p","This browser doesn't seem to support the `files` property of file inputs."):bodyAppend("p","Um, couldn't find the fileinput element."):bodyAppend("p","The file API isn't supported on this browser yet.")}function saveFile(){startSave=Date.now(),ff5File.save();var e=new Blob([bin.bytes.buffer]);saveAs(e,"save.bin"),saveTime=Date.now()-startSave,$("#status").text("saveTime: "+saveTime)}function Bin(e){this.bytes=new Int8Array(e),this.getByte=function(e){return this.bytes[e]},this.getInt=function(e,t){return 1==t?int1(this.bytes[e]):2==t?int2(this.bytes[e],this.bytes[e+1]):4==t?int4(this.bytes[e],this.bytes[e+1],this.bytes[e+2],this.bytes[e+3]):0},this.setInt=function(e,t,i){t=1==i?[t>>>0]:2==i?[t>>>0,t>>>8]:bytes(t);return this.bytes.set(t,e),this},this.getInt1s=function(e,t){for(var i=[],a=0;a<t;a++)i.push({int1:this.getInt(e+a,1)});return i},this.setInt1s=function(e,t){for(var i=0;i<t.length;i++)this.setInt(e+i,t[i].int1,1);return this},this.getInt2s=function(e,t){for(var i=[],a=0;a<t;a++)i.push({int2:this.getInt(e+2*a,2)});return i},this.setInt2s=function(e,t){for(var i=0;i<t.length;i++)this.setInt(e+2*i,t[i].int2,2);return this},this.getInt4s=function(e,t){for(var i=[],a=0;a<t;a++)i.push({int4:this.getInt(e+4*a,4)});return i},this.setInt4s=function(e,t){for(var i=0;i<t.length;i++)this.setInt(e+4*i,t[i].int4,4);return this},this.getBits=function(e,t){for(var i=[],a=0;a<t;a++)for(var n=int1(this.getByte(e+a)),r=0;r<8;r++)i.push({bit:bool(n>>r&1)});return i},this.setBits=function(e,t){for(var i=t.length/8,a=0;a<i;a++)this.setInt(e+a,this.toInt1(t,8*a),1);return this},this.toInt1=function(e,t){for(var i=0,a=0;a<8;a++)e[t+a].bit&&(i+=Math.pow(2,a));return i}}function FF5File(i,e){var a=8192*e;this.Gill=i.getInt(32+a,4),this.Bartz=new Char(i,1100+a),this.Lenna=new Char(i,1100+a+260),this.Galuf=new Char(i,1100+a+520),this.Faris=new Char(i,1100+a+780),this.Krile=new Char(i,1100+a+1040),this.items=i.getInt1s(37+a,261).map(function(e,t){return{name:itemName(t),int1:i.options.allItems||e.int1}}),this.jobs=i.getBits(27+a,4).map(function(e,t){return{name:JobName[t],bit:e.bit}}),this.mgks=i.getBits(952+a,42).map(function(e,t){return{name:magicName(t),bit:i.options.allMagic||e.bit}}),this.slains=i.getInt4s(540,450).map(function(e,t){return{name:"mon"+t,int4:i.options.allSlain||e.int4}}),this.save=function(){this.Bartz.save(),this.Lenna.save(),this.Galuf.save(),this.Faris.save(),this.Krile.save(),i.setInt(32+a,parseInt(this.Gill),4).setInt1s(37+a,this.items).setBits(27+a,this.jobs).setBits(952+a,this.mgks).setInt4s(540,this.slains);for(var e=0,t=0;t<5036;t++)e+=i.getByte(a+t);i.setInt(5036+a,e,4)}}function Char(e,t){this.Exp=e.getInt(t,4);var i=e.getInt1s(t+14,25),a=e.getInt2s(t+44,25);this.jobs=[];for(var n=0;n<25;n++)this.jobs.push({name:JobName[n+2],int1:i[n].int1,int2:e.options.allJobsABP||a[n].int2});this.save=function(){e.setInt(t,parseInt(this.Exp),4).setInt1s(t+14,this.jobs).setInt2s(t+44,this.jobs)}}function int1(e){return 255&e}function int2(e,t){return 255&e|t<<8&65280}function int4(e,t,i,a){return 255&e|t<<8&65280|i<<16&16711680|a<<24&4278190080}function bytes(e){return[e>>>0,e>>>8,e>>>16,e>>>24]}function bool(e){return 0!==e}function bodyAppend(e,t){e=document.createElement(e);e.innerHTML=t,document.body.appendChild(e)}function itemName(e){var t=ItemNames.get(e);return t||"item-"+e+" ???"}function magicName(e){var t=MagicNames.get(e);return t||"mgk-"+e+" ???"}const JobName=["Hello","Knight","Monk","Thief","Dragon","Ninja","Samurai","Berserker","Ranger","MysticKnight","WhiteMage","BlackMage","TimeMage","Summoner","BlueMage","RedMage","BeastMaster","Chemist","Geomancer","Bard","Dancer","Necromancer","Oracle","Cannoneer","Gladiator","Mime","26 ???","27 ???","28 ???","29 ???","30 ???","31 ???","32 ???","33 ???","34 ???","35 ???"],ItemNames=new Map([[0,"Potion"],[1,"Hi-Potion"],[2,"Phoenix Down"],[3,"Ether"],[4,"Antidote"],[5,"Eye Drops"],[6,"Gold Needle"],[7,"Maiden's Kiss"],[8,"Mallet"],[9,"Holy Water"],[10,"Tent"],[11,"Cottage"],[12,"Elixir"],[13,"Goliath Tonic"],[14,"Power Drink"],[15,"Speed Shake"],[16,"Iron Draft"],[17,"Hero Cocktail"],[18,"Turtle Shell"],[19,"Dragon Fang"],[20,"Dark Matter"],[21,"Magic Lamp"],[22,"Flame Scroll"],[23,"Water Scroll"],[24,"Lightning Scroll"],[25,"Ash"],[26,"Shuriken"],[27,"Fuma Shuriken"],[28,"Buckshot"],[29,"Blastshot"],[30,"Blitzshot"],[31,"Ramuh"],[32,"Catoblepas"],[33,"Golem"],[34,"Dragon Seal"],[35,"Omega Badge"],[36,"Medal of Smithing"],[37,"Knife"],[38,"Dagger"],[39,"Mythril Knife"],[40,"Mage Masher"],[41,"Main Gauche"],[42,"Orichalcum Dirk"],[43,"Dancing Dagger"],[44,"Air Knife"],[45,"Theif Knife"],[46,"Assassin's Dagger"],[47,"Man-Eater"],[48,"Gladius"],[49,"Chicken Knife"],[50,"Kunai"],[51,"Kodachi"],[52,"Sasuke's Katana"],[53,"Kagenui"],[54,"Broadsword"],[55,"Long Sword"],[56,"Mythril Sword"],[57,"Coral Sword"],[58,"Ancient Sword"],[59,"Sleep Blade"],[60,"Rune Blade"],[61,"Great Sword"],[62,"Excalipoor"],[63,"Enhancer"],[64,"Ultima Weapon"],[65,"Flametongue"],[66,"Icebrand"],[67,"Blood Sword"],[68,"Defender"],[69,"Excalibur"],[70,"Ragnarok"],[71,"Apocalypse"],[72,"Brave Blade"],[73,"Spear"],[74,"Mythril Spear"],[75,"Trident"],[76,"Wind Spear"],[77,"Heavy Lance"],[78,"Javelin"],[79,"Twin Lance"],[80,"Partisan"],[81,"Holy Lance"],[82,"Dragon Lance"],[83,"Longinus"],[84,"Battle Axe"],[85,"Mythril Hammer"],[86,"Ogre Killer"],[87,"War Hammer"],[88,"Death Sickle"],[89,"Poison Axe"],[90,"Gaia Hammer"],[91,"Rune Axe"],[92,"Thor Hammer"],[93,"Titan's Axe"],[94,"Earthbreaker"],[95,"Ashura"],[96,"Wind Slash"],[97,"Osafune"],[98,"Kotetsu"],[99,"Kiku-ichimonji"],[100,"Murasame"],[101,"Masamune"],[102,"Murakumo"],[103,"Mutsunokami"],[104,"Rod"],[105,"Flame Rod"],[106,"Frost Rod"],[107,"Thunder Rod"],[108,"Poison Rod"],[109,"Lilith Rod"],[110,"Magus Rod"],[111,"Wonder Wand"],[112,"Demon's Rod"],[113,"Staff"],[114,"Healing Staff"],[115,"Power Staff"],[116,"Staff of Light"],[117,"Sage's Staff"],[118,"Judgement Staff"],[119,"Mace of Zeus"],[120,"Flail"],[121,"Morning Star"],[122,"Silber Bow"],[123,"Flame Bow"],[124,"Frost Bow"],[125,"Thunder Bow"],[126,"Dark Bow"],[127,"Magic Bow"],[128,"Killer Bow"],[129,"Elven Bow"],[130,"Hayate Bow"],[131,"Aevis Killer"],[132,"Yoichi's Bow"],[133,"Artemis Bow"],[134,"Fairy's Bow"],[135,"Silver Harp"],[136,"Dream Harp"],[137,"Lamia's Harp"],[138,"Apollo's Harp"],[139,"Whip"],[140,"Blitz Whip"],[141,"Chain Whip"],[142,"Beast Killer"],[143,"Fire Lash"],[144,"Dragon's Whisker"],[145,"Diamond Bell"],[146,"Gaia Bell"],[147,"Rune Chime"],[148,"Tinklebell"],[149,"Moonring Blade"],[150,"Rising Sun"],[151,"Leather Shield"],[152,"Bronze Shield"],[153,"Iron Shield"],[154,"Mythril Shield"],[155,"Golden Shield"],[156,"Aegis Shield"],[157,"Diamond Shield"],[158,"Flame Shield"],[159,"Ice Shield"],[160,"Crystal Shield"],[161,"Genji Shield"],[162,"Force Shield"],[163,"Leather Cap"],[164,"Plumed Hat"],[165,"Hypno Crown"],[166,"Royal Crown"],[167,"Green Beret"],[168,"Twist Headband"],[169,"Tiger Mask"],[170,"Black Cowl"],[171,"Lamia's Tiara"],[172,"Wizard's Hat"],[173,"Sage's Miter"],[174,"Circlet"],[175,"Gold Hairpin"],[176,"Ribbon"],[177,"Bronze Helm"],[178,"Iron Helm"],[179,"Mythril Helm"],[180,"Golden Helm"],[181,"Diamond Helm"],[182,"Crystal Helm"],[183,"Genji Helm"],[184,"Grand Helm"],[185,"Thornlet"],[186,"Leather Armor"],[187,"Angel Robe"],[188,"Mirage Vest"],[189,"Rainbow Dress"],[190,"Vishnu Vest"],[191,"Copper Cuirass"],[192,"Kenpo Gi"],[193,"Silver Plate"],[194,"Ninja Suit"],[195,"Power Sash"],[196,"Diamond Plate"],[197,"Black Garb"],[198,"Bone Mail"],[199,"Cotton Robe"],[200,"Silk Robe"],[201,"Sage's Surplice"],[202,"Gaia Gear"],[203,"Luminous Robe"],[204,"Black Robe"],[205,"White Robe"],[206,"Robe of Lords"],[207,"Bronze Armor"],[208,"Iron Armor"],[209,"Mythril Armor"],[210,"Golden Armor"],[211,"Diamond Armor"],[212,"Crystal Armor"],[213,"Genji Armor"],[214,"Maximillian"],[215,"Mythril Glove"],[216,"Thief's Gloves"],[217,"Gauntlets"],[218,"Titan's Gloves"],[219,"Genji Gloves"],[220,"Silver Armlet"],[221,"Power Armlet"],[222,"Diamond Armlet"],[223,"Hyper Wrist"],[224,"Leather Shoes"],[225,"Hermes Sandals"],[226,"Red Slippers"],[227,"Angel Ring"],[228,"Flame Ring"],[229,"Coral Ring"],[230,"Reflect Ring"],[231,"Protect Ring"],[232,"Cursed Ring"],[233,"Kaiser Knuckles"],[234,"Silver Specs"],[235,"Elven Mantle"],[236,"Sorceror's Mantle"],[237,"Chaos Orb"],[238,"Crystal Orb"],[239,"Kornago Gourd "]]),MagicNames=new Map([[19,"Cure"],[20,"Libra"],[21,"Poisona"],[22,"Silence"],[23,"Protect"],[24,"Mini"],[25,"Cura"],[26,"Raise"],[27,"Confuse"],[28,"Blink"],[29,"Shell"],[30,"Esuna"],[31,"Curaga"],[32,"Reflect"],[33,"Berserk"],[34,"Arise"],[35,"Holy"],[36,"Dispel"],[37,"Fire"],[38,"Blizzard"],[39,"Thunder"],[40,"Poison"],[41,"Sleep"],[42,"Toad"],[43,"Fira"],[44,"Blizzara"],[45,"Thundara"],[46,"Drain"],[47,"Break"],[48,"Bio"],[49,"Firaga"],[50,"Blizzaga"],[51,"Thundaga"],[52,"Flare"],[53,"Death"],[54,"Osmose"],[55,"Speed"],[56,"Slow"],[57,"Regen"],[58,"Mute"],[59,"Haste"],[60,"Float"],[61,"Gravity"],[62,"Stop"],[63,"Teleport"],[64,"Comet"],[65,"Slowga"],[66,"Return"],[67,"Graviga"],[68,"Hastega"],[69,"Old"],[70,"Meteor"],[71,"Quick"],[72,"Banish"],[73,"Chocobo"],[74,"Sylph"],[75,"Remora"],[76,"Shiva"],[77,"Ramuh"],[78,"Ifrit"],[79,"Titan"],[80,"Golem"],[81,"Catoblepas"],[82,"Carbuncle"],[83,"Syldra"],[84,"Odin"],[85,"Phoenix"],[86,"Leviathan"],[87,"Bahamut"],[106,"Sinewy Etude"],[107,"Swift Song"],[108,"Mighty March"],[109,"Mana's Pean"],[110,"Hero's Rime"],[111,"Requiem"],[112,"Romeo's Ballad"],[113,"Alluring Air"],[299,"Doom"],[300,"Roulette"],[301,"Aqua Breath"],[302,"Level 5 Death"],[303,"Level 4 Graviga"],[304,"Level 2 Old"],[305,"Level 3 Flare"],[306,"Pond's Chorus"],[307,"Lilliputian Lyric"],[308,"Flash"],[309,"Time Slip"],[310,"Moon Flute"],[311,"Death Claw"],[312,"Aero"],[313,"Aera"],[314,"Aeroga"],[315,"Flame Thrower"],[316,"Goblin Punch"],[317,"Dark Spark"],[318,"Off-Guard"],[319,"Transfusion"],[320,"Mind Blast"],[321,"Vampire"],[322,"Magic Hammer"],[323,"Mighty Guard"],[324,"Self-Destruct"],[325,"???"],[326,"1000 Needles"],[327,"White Wind"],[328,"Missile"]]);